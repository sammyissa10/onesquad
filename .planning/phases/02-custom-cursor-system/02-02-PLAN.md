---
phase: 02-custom-cursor-system
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/CustomCursor/CustomCursor.tsx
  - src/components/ui/Button.tsx
  - src/components/sections/Hero.tsx
  - src/components/sections/ServicesPreview.tsx
  - src/components/sections/PortfolioPreview.tsx
  - src/components/sections/Testimonials.tsx
  - src/components/sections/CTABanner.tsx
  - src/components/layout/Header.tsx
  - src/components/layout/Footer.tsx
autonomous: false

must_haves:
  truths:
    - "Cursor scales up and changes appearance when hovering links, buttons, and cards"
    - "Cards (service, portfolio, testimonial) have a distinct cursor reaction inspired by kota.co.uk/strangepixels.co — not a generic scale-up"
    - "Cursor shows contextual text labels ('View', 'Drag') on specific interactive elements"
    - "Custom cursor does not interfere with native click events or keyboard navigation after hover system is added"
    - "At least 3 distinct hover patterns are visible across the site (default, button/link, card, text-label)"
    - "Hover state transitions animate smoothly (not instant snap)"
  artifacts:
    - path: "src/components/CustomCursor/CustomCursor.tsx"
      provides: "Hover state system with data-attribute detection and GSAP-driven state transitions"
      contains: "data-cursor"
    - path: "src/components/ui/Button.tsx"
      provides: "Button component with data-cursor attribute"
      contains: "data-cursor"
    - path: "src/components/sections/ServicesPreview.tsx"
      provides: "Service cards with data-cursor='card' attribute"
      contains: "data-cursor"
    - path: "src/components/sections/PortfolioPreview.tsx"
      provides: "Portfolio cards with data-cursor='view' and data-cursor-text='View'"
      contains: "data-cursor-text"
  key_links:
    - from: "src/components/CustomCursor/CustomCursor.tsx"
      to: "document (event delegation)"
      via: "mouseover event listener on document detecting data-cursor attributes"
      pattern: "data-cursor"
    - from: "src/components/ui/Button.tsx"
      to: "src/components/CustomCursor/CustomCursor.tsx"
      via: "data-cursor='button' attribute triggers cursor state change"
      pattern: "data-cursor.*button"
---

<objective>
Add a data-attribute-driven hover state system to the CustomCursor component, implementing distinct cursor reactions for different interactive element types. Cards get a unique kota.co.uk/strangepixels.co-inspired reaction (cursor expands into a large circle with "View" text label, filling with a semi-transparent color), buttons/links get a subtle scale-down + invert effect, and specific elements get contextual text labels. Then apply data-cursor attributes to existing components across the site.

Purpose: Completes CURS-02 (hover scale + color change), CURS-03 (contextual text), and validates CURS-05 (non-interference) across all interactive elements. This is where the cursor becomes a *design element* rather than just a pointer replacement — the card hover reaction should feel intentional and unique.

Output: Complete custom cursor system with 4+ distinct hover states applied site-wide, ready for future phases to add data-cursor attributes to new components.
</objective>

<execution_context>
@C:/Users/sammy/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/sammy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan summary (cursor foundation)
@.planning/phases/02-custom-cursor-system/02-01-SUMMARY.md

# Files this plan modifies
@src/components/CustomCursor/CustomCursor.tsx
@src/components/ui/Button.tsx
@src/components/sections/Hero.tsx
@src/components/sections/ServicesPreview.tsx
@src/components/sections/PortfolioPreview.tsx
@src/components/sections/Testimonials.tsx
@src/components/sections/CTABanner.tsx
@src/components/layout/Header.tsx
@src/components/layout/Footer.tsx

# Color palette reference
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add data-attribute hover state system to CustomCursor with 4 distinct cursor patterns</name>
  <files>src/components/CustomCursor/CustomCursor.tsx</files>
  <action>
Extend the existing CustomCursor component to detect hover states via data attributes on page elements and animate the cursor into different visual states.

**Hover state detection (event delegation):**
- Add a `mouseover` event listener on `document` that checks `(e.target as HTMLElement).closest('[data-cursor]')`.
- When a `data-cursor` element is found, read its value and optional `data-cursor-text` attribute.
- Store the current cursor state in a `useRef<string>('default')` (NOT useState — minimize re-renders).
- Store the current cursor text in a `useRef<string>('')`.
- When cursor state changes, call the appropriate GSAP animation on the cursor elements.

**The 4 distinct cursor patterns:**

1. **`default`** — Base state (from plan 02-01)
   - Dot: 8px coral circle, opacity 1
   - Follower: 32px coral border ring, `mix-blend-mode: difference`
   - No text

2. **`data-cursor="button"`** — For buttons and standalone links
   - Dot: shrinks to 4px
   - Follower: shrinks to 20px, fills with white at 80% opacity, `mix-blend-mode: difference`
   - Effect: cursor "tightens" on buttons — compact, focused. The blend mode inversion creates automatic contrast (appears dark on light buttons, light on dark buttons)
   - Animation: `duration: 0.3, ease: 'power2.out'`

3. **`data-cursor="card"`** — For service, portfolio, and testimonial cards (LOCKED DECISION: distinct, kota.co.uk/strangepixels.co inspired)
   - Dot: fades out (`opacity: 0`)
   - Follower: expands dramatically to 80px, fills with coral (`#E2795E`) at 30% opacity, border becomes transparent, `mix-blend-mode: normal` (not difference — we want the coral tint visible)
   - If `data-cursor-text` is present: show text inside follower (see pattern 4)
   - Effect: cursor becomes a large, glowing "spotlight" that creates a warm coral wash over the card area — mimics kota.co.uk's effect of the cursor area lighting up on card hover. The large size + color fill makes it feel intentional and designed, not generic.
   - Animation: `duration: 0.4, ease: 'power3.out'` (slightly slower for dramatic effect)

4. **`data-cursor="text"`** — For elements with contextual text labels (portfolio "View", sliders "Drag")
   - Dot: fades out (`opacity: 0`)
   - Follower: expands to 80px (same as card), fills with navy (`#051733`) at 90% opacity, `mix-blend-mode: normal`
   - Text: Shows `data-cursor-text` value (e.g., "View") in white, centered inside follower
   - Text animation: fade in from `opacity: 0, scale: 0.8` to `opacity: 1, scale: 1` with `duration: 0.2, ease: 'power2.out'`
   - Animation: `duration: 0.4, ease: 'power3.out'`
   - Effect: cursor becomes a dark pill with white text — high contrast, clear affordance

**Text label implementation:**
- Add a `<span>` element inside the follower div with ref `cursorTextRef`.
- Style it: `position: absolute`, centered with flex, `font-size: 12px`, `font-weight: 600`, `text-transform: uppercase`, `letter-spacing: 0.05em`, `color: white`, `pointer-events: none`, `white-space: nowrap`.
- When cursor text changes, update the span's `textContent` directly (ref, not state) and animate opacity/scale.
- When cursor returns to default, animate text out and clear.

**State transition logic:**
- Create a `setCursorState(state: string, text: string)` function that:
  1. Compares with current state ref — if same, skip (no re-animation)
  2. Kills any in-progress cursor animations (`gsap.killTweensOf(cursorDotRef.current)`, same for follower)
  3. Applies the appropriate GSAP `.to()` animations based on state
  4. Updates refs

**Reverting to default:**
- When `mouseover` fires and no `[data-cursor]` ancestor is found, revert to default state.
- Use `gsap.to()` with same durations as the enter animations for smooth exit.

**Important implementation notes:**
- All hover animations use `gsap.to()` (not `quickTo` — these are discrete state transitions, not continuous tracking)
- The quickTo mouse tracking from plan 02-01 continues running independently — hover states only change cursor appearance, not position tracking
- Keep `pointer-events: none` on ALL cursor elements including the text span
- The `mouseover` listener uses event delegation (single listener on document) for performance — no per-element listeners
- For the expanded card/text states, the follower needs `border-radius: 50%` maintained and `display: flex; align-items: center; justify-content: center` for text centering
  </action>
  <verify>
- `npx tsc --noEmit` passes with zero TypeScript errors
- `npm run build` succeeds
- File contains `data-cursor` string (hover detection)
- File contains at least 4 distinct cursor state handlers (default, button, card, text)
- File contains `cursorTextRef` or equivalent text element
- File contains `gsap.killTweensOf` for animation cleanup between states
- File still contains `pointer-events: none` on all elements
- File still contains `MOTION_QUERIES` for reduced-motion support
  </verify>
  <done>
CustomCursor enhanced with 4 distinct hover patterns driven by data-cursor attributes: default (dot + ring), button (compact/inverted), card (large coral spotlight — kota/strangepixels inspired), and text (navy pill with white label). All transitions use GSAP .to() with smooth easing. Event delegation via single document mouseover listener. Text labels supported via data-cursor-text attribute. Pointer-events: none maintained on all elements.
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply data-cursor attributes to existing interactive components across the site</name>
  <files>src/components/ui/Button.tsx, src/components/sections/Hero.tsx, src/components/sections/ServicesPreview.tsx, src/components/sections/PortfolioPreview.tsx, src/components/sections/Testimonials.tsx, src/components/sections/CTABanner.tsx, src/components/layout/Header.tsx, src/components/layout/Footer.tsx</files>
  <action>
Add `data-cursor` attributes to existing interactive elements across the site. Each file needs minimal changes — just adding the appropriate data attribute to the right elements.

**Button.tsx:**
- Add `data-cursor="button"` to the `<motion.button>` element in the render. Add it to the `className` line or as a separate prop. This makes ALL buttons site-wide automatically get the cursor reaction.

**Header.tsx:**
- Add `data-cursor="button"` to navigation links (`<Link>` elements in the nav)
- Add `data-cursor="button"` to the mobile menu toggle button
- Add `data-cursor="button"` to any CTA buttons in the header

**Footer.tsx:**
- Add `data-cursor="button"` to footer links (`<Link>` or `<a>` elements)
- Add `data-cursor="button"` to social media icon links

**Hero.tsx:**
- Add `data-cursor="button"` to CTA buttons/links in the hero section
- If hero has a background image or video area, add `data-cursor="text"` with `data-cursor-text="Explore"` to the hero container (Claude's discretion — only if it enhances the design)

**ServicesPreview.tsx:**
- Add `data-cursor="card"` to each service card container element
- Add `data-cursor-text="View"` to the card containers (so the cursor shows "View" text on card hover, using the card+text combined state)

**PortfolioPreview.tsx:**
- Add `data-cursor="text"` with `data-cursor-text="View"` to each portfolio project card/link
- These use the navy pill + "View" text pattern — distinct from service cards

**Testimonials.tsx:**
- Add `data-cursor="card"` to each testimonial card element (coral spotlight effect, no text)

**CTABanner.tsx:**
- Add `data-cursor="button"` to the CTA button(s)

**Implementation approach:**
- Read each file first to understand its JSX structure
- Add data attributes as HTML attributes on the appropriate DOM elements
- For components that render `<Link>` elements, add `data-cursor` directly to the `<Link>`
- For card containers, find the outermost clickable/hoverable wrapper and add `data-cursor` there
- Do NOT restructure any component — only add data attributes
- If a card already has an `onClick` or wrapping `<Link>`, add `data-cursor` to that element (closest interactive ancestor)

**Note on card hover state with text:**
When `data-cursor="card"` and `data-cursor-text="View"` are both present on the same element, the cursor component should check for `data-cursor-text` inside the card handler and show the text if present. This means in Task 1's card state handler, add: if text is provided, also show the text label (same as text state but with coral fill instead of navy). Update Task 1's implementation if needed during execution.
  </action>
  <verify>
- `npm run build` succeeds with zero errors
- `grep -r "data-cursor" src/components/` returns matches in at least 6 files
- Button.tsx contains `data-cursor="button"`
- ServicesPreview.tsx contains `data-cursor="card"`
- PortfolioPreview.tsx contains `data-cursor-text="View"`
- Header.tsx contains `data-cursor="button"`
- All modified files still compile without TypeScript errors
  </verify>
  <done>
Data-cursor attributes applied to all major interactive components: buttons (compact/invert), service cards (coral spotlight), portfolio cards (navy pill + "View" text), testimonial cards (coral spotlight), navigation links (compact/invert), and CTA buttons (compact/invert). At least 4 distinct hover patterns are now visible across the site. All changes are additive — no component restructuring.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify custom cursor system looks and feels right across the site</name>
  <files>n/a</files>
  <action>
**What was built:**
Complete custom cursor system with 4 distinct hover patterns applied site-wide:
- Default: small coral dot + trailing ring
- Buttons/links: compact cursor with blend-mode inversion
- Cards (service, portfolio, testimonial): large coral spotlight expansion (kota.co.uk/strangepixels.co inspired)
- Portfolio cards: navy pill with "View" text label

**How to verify:**
1. Open http://localhost:3000 in desktop browser
2. **Default cursor**: Move mouse over empty areas — small coral dot + trailing ring visible, smooth lag on the follower
3. **Button hover**: Hover any button — cursor tightens (shrinks), blend mode creates contrast effect
4. **Navigation links**: Hover nav links in header — same compact cursor reaction
5. **Service cards**: Hover a service card on homepage — cursor expands to large coral spotlight (distinct from button hover)
6. **Portfolio cards**: Hover a portfolio project — cursor becomes navy pill showing "View" text
7. **Testimonial cards**: Hover a testimonial — coral spotlight (same as service cards)
8. **CTA buttons**: Hover CTA banner button — compact cursor (same as other buttons)
9. **Click test**: Click several buttons and links — all function normally, no click interception
10. **Text selection**: Select text on the page — works normally
11. **Keyboard nav**: Press Tab through interactive elements — focus rings visible, no cursor interference
12. **Touch test** (optional): Open Chrome DevTools, toggle device toolbar to mobile — cursor should be completely hidden
13. **Reduced motion** (optional): Chrome DevTools > Rendering > Emulate prefers-reduced-motion: reduce — cursor should disappear
14. **Route change**: Navigate to 3+ different pages — cursor persists, no duplicates, no errors in console

**Key judgment calls:**
- Does the card hover feel distinct and intentional (not just a bigger circle)?
- Does the follower ring lag feel smooth (not sluggish or jittery)?
- Do the hover transitions feel polished (smooth in and out)?
- Does the blend mode work well across light and dark sections?

**Resume signal:** Type "approved" to complete Phase 02, or describe any issues (e.g., "follower too slow", "card hover needs more color", "blend mode looks wrong on dark sections")
  </action>
  <verify>User visually confirms cursor behavior across 14 verification steps</verify>
  <done>Human verified: cursor system looks polished, all 4 hover patterns feel intentional, no click/keyboard interference, hidden on touch/reduced-motion</done>
</task>

</tasks>

<verification>
1. `npm run build` passes with zero errors
2. 4+ distinct cursor patterns visible on the homepage alone (default, button, card, text-label)
3. Cursor follows mouse smoothly — dot near-instant, follower with visible trail
4. Card hover creates large coral spotlight (CURS-02 + locked decision for distinct card reaction)
5. Portfolio card hover shows "View" text inside cursor (CURS-03)
6. All buttons, links, and interactive elements remain clickable (CURS-05)
7. Keyboard navigation works unchanged (CURS-05)
8. Touch devices show no custom cursor (CURS-04)
9. Reduced-motion hides cursor entirely
10. No console errors across 5+ page navigations
</verification>

<success_criteria>
- CURS-01: Complete — cursor follows with GSAP interpolation and visible lag (dot + follower)
- CURS-02: Complete — cursor scales/changes on buttons (compact), cards (spotlight), portfolio (pill)
- CURS-03: Complete — "View" text shown on portfolio cards; system supports any text via data-cursor-text
- CURS-04: Complete — hidden on touch via CSS + JS
- CURS-05: Complete — pointer-events: none verified across all hover states; keyboard nav unaffected
- Locked decision honored: Card hover is distinct and kota/strangepixels-inspired (coral spotlight expansion, not generic scale-up)
- Phase 02 success criteria fully met: all 4 criteria from ROADMAP.md satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/02-custom-cursor-system/02-02-SUMMARY.md`
</output>
